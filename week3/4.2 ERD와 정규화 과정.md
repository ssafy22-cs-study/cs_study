## ERD

> **Entity Relationship Diagram**
> 

릴레이션 간 관계를 나타낸 다이어그램

데이터베이스를 구축하는 뼈대

## Ex. ERD

요구사항

- 영업사원은 0~n명의 고객을 관리
- 고객은 0~n개의 주문을 넣을 수 있음
- 주문에는 1~n개의 상품이 들어감

<img width="450" alt="Untitled" src="https://github.com/ssafy22-cs-study/cs_study/assets/65950056/59b3f86b-a504-45b4-a1e7-931294209e81">

## 정규화 과정

> 릴레이션을 분리하는 과정
> 

→ 릴레이션 간 잘못된 종속 관계로 인해 발생하는 데이터베이스 이상 현상을 해결

→ 저장 공간을 효율적으로 사용하기 위해

### 데이터베이스 이상 현상?

1. 삭제 이상 : 필요한 정보를 함께 삭제하지 않고서는 어떤 정보를 삭제하는 것이 불가
    
    
    | 학번 | 과목명 | 과목코드 | 성적 | 이름 |
    | --- | --- | --- | --- | --- |
    | 201900 | 운영체제 | 123 | 90 | A |
    | 201901 | 데이터베이스 | 124 | 80 | B |
    
    → B의 데이터베이스 성적만 삭제 불가
    
2. 삽입 이상 : 불필요한 정보를 함께 저장하지 않고서는 어떤 정보를 저장하는 것이 불가
    
    
    | 201902 | 컴퓨터구조 |  | 70 | C |
    | --- | --- | --- | --- | --- |
    
    → 과목 코드 없이 데이터 삽입 불가
    
3. 갱신 이상 : 반복된 데이터 중 일부를 갱신할 시 데이터의 불일치 발생
    
    
    | 학번 | 과목명 | 과목코드 | 성적 | 이름 |
    | --- | --- | --- | --- | --- |
    | 201900 | 운영체제 | 123 | 90 | A C |
    | 201901 | 데이터베이스 | 124 | 80 | B |
    | 201900 | 컴파일러 | 120 | 70 | A |
    
    → 첫번째 셀의 이름을 C로 바꾸면, 세번째 셀과 첫번째 셀은 이제 더이상 일치하지 않음
    
    → 이를 해결하기 위해선 모든 셀에서 A에 해당하는 값을 C로 바꿔줘야 함
    

## 제 1 정규형

모든 도메인이 더 이상 분해될 수 없는 값으로만 구성되어야 함

한 개의 기본키에 대해 두 개 이상의 값을 가지면 안됨

### Before

| userNum | userID | courseName | score |
| --- | --- | --- | --- |
| 1 | kim | {c++코딩테스트, 프런트특강} | {90, 10} |
| 2 | park | {DS특강, 코드포스특강} | {7, 8} |

### After

| userNum | userID | courseName | score |
| --- | --- | --- | --- |
| 1 | kim | c++코딩테스트 | 90 |
| 1 | kim | 프런트특강 | 10 |
| 2 | park | DS특강 | 7 |
| 2 | park | 코드포스특강 | 8 |

→ 하나의 값만 가질 수 있음

## 제 2 정규형

제 1 정규형 plus, 부분 함수의 종속성 제거

→ 기본키가 아닌 모든 속성은 기본키에 완전 종속되어야 한다.

### Before

| userNum | userID | courseName | score |
| --- | --- | --- | --- |
| 1 | kim | c++코딩테스트 | 90 |
| 1 | kim | 프런트특강 | 10 |
| 2 | park | DS특강 | 7 |
| 2 | park | 코드포스특강 | 8 |

→ userNum은 기본키인 수강명과 관련이 없음 오직 userID와만 관련이 있음

### After

| userNum | userID |
| --- | --- |
| 1 | kim |
| 2 | park |

| userID | courseName | score |
| --- | --- | --- |
| kim | c++코딩테스트 | 90 |
| kim | 프런트특강 | 10 |
| park | DS특강 | 7 |
| park | 코드포스특강 | 8 |

→ 완전 함수 종속적인 형태로 데이터베이스를 분리

*완전 함수 종속적 형태

<img width="863" alt="Untitled-2" src="https://github.com/ssafy22-cs-study/cs_study/assets/65950056/c449474f-9cd6-4aba-bd08-9ac51168cc15">

위의 예제에서는 userID에 따라 courseName, score가 정의 & userNum이 정의

## 제 3 정규형

제 2 정규형 plus, 기본키를 제외한 모든 속성이 이행적 함수 종속을 만족하지 않는 상태

*이행적 함수 종속 : A→B & B→C = A→C (C가 A에 이행적으로 함수 종속이 되었다.)

⇒ 테이블 내의 모든 속성이 기본키에만 의존해야 한다.

### Before

| userID | grade | discountRate |
| --- | --- | --- |
| kim | A | 30% |
| park | B | 20% |
| lee | C | 10% |

→ 할인율은 등급에 따라 정해져 있음

→ 할인율은 기본키인 userID에 의존하지 않고, 등급에 의존함

### After

| userID | grade |
| --- | --- |
| kim | A |
| park | B |
| lee | C |

| grade | discountRate |
| --- | --- |
| A | 30% |
| B | 20% |
| C | 10% |

## 보이스/코드 정규형

제 3 정규형 plus, 모든 결정자가 후보키여야 한다.

(후보키의 조건 : 유일성, 최소성)

### Before

| 학번 | 과목 | 교수 |
| --- | --- | --- |
| 201900 | 데이터베이스 | kim |
| 201902 | 데이터베이스 | kim |
| 201903 | 정보보안 | park |

→ 교수는 한 개의 과목만을 가르친다고 가정 시, 교수를 보고 과목을 결정지을 수 있음

→ 즉, 교수가 과목의 결정자임

→ 그러나 교수는 후보키가 아님 why? 유일성을 만족하지 않았기 때문 (2번 등장)

### After

| 학번 | 교수 |
| --- | --- |
| 201900 | kim |
| 201902 | kim |
| 201903 | park |

| 과목 | 교수 |
| --- | --- |
| 데이터베이스 | kim |
| 정보보안 | park |

→ 교수 속성 분리
